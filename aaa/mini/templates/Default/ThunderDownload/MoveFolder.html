<html>

<head>
    <meta name="viewport" content="width=device-width" />
    <title>移动文件夹</title>
    <link href="/static/css/public.css" rel="stylesheet" />
    <script src="/static/js/jquery-1.8.2.min.js"></script>
    <script src="/static/js/public.js"></script>
    <style>
        .btn {
            width: 80px;
            height: 30px;
            line-height: 30px;
        }
        
        .selmain {
            margin-top: 50px;
        }
        
        .selmain select {
            margin-left: 20px;
        }
        
        .btnmain {
            margin-top: 50px;
            text-align: right;
        }
        
        .btnmain input {
            margin-right: 20px;
        }
    </style>
    <script language=javascript>
        <!--
        window.onerror = function() {
                return true;
            }
            // -->
    </script>
    <script>
        jQuery(function($) {
            LodingFolder("PHOTO");
            $("#drMainList").change(function() {
                var theme = $(this).val();
                LodingFolder(theme);
            })

            $("#btnClear").click(function() {
                parent.parentClickbyMove();
            })
            $("#btnSub").click(function() {
                var starPath = getQueryString("starPath");
                var theme = $("#drMainList").val();
                var endPath = "";
                switch (theme) {
                    case "PHOTO":
                        endPath = "/" + $("#drChildrenList").val() + "/";
                        break;
                    case "MUSIC":
                        endPath = "/" + $("#drChildrenList").val() + "/";
                        break;
                    case "VIDEO":
                        endPath = "/" + $("#drChildrenList").val() + "/";
                        break;
                    default:
                        endPath = "Photo/" + $("#drChildrenList").val() + "/";
                        break;
                }

                var datas = {
                        starPath: starPath,
                        endPath: endPath,
                        endType: theme
                    }
                    // alert(starPath+"---"+endPath+"---"+theme);
                $.post("/FileCenter/MoveFile", datas, function(data, result) {
                    if (result = "success") {
                        alert(data.data);
                        parent.parentClickbyMove();
                    }
                });
            })
        });

        function LodingFolder(theme) {
            var datas = {
                theme: theme
            }
            $.post("/FileCenter/GetFolderInfoByTheme", datas, function(data, result) {

                if (result == "success") {
                    var dataObj = eval("(" + data.data + ")"); //转换为json对象 

                    $("#drChildrenList option").remove();
                    $.each(dataObj.folder, function(idx, item) {
                        $("#drChildrenList").append("<option value=\"" + item + "\">" + item + "</option>");
                    });
                }

            });
        }
    </script>
</head>

<body>
    <article>
        <div class="selmain">
            <select id="drMainList">
                <option value="PHOTO" selected="selected">照片中心</option>
                <option value="MUSIC">音频中心</option>
                <option value="VIDEO">视频中心</option>
            </select>
            <select id="drChildrenList">
                <option></option>
            </select>
        </div>
        <div class="btnmain">
            <input type="submit" value="确定" class="btn" id="btnSub">
            <input type="button" value="取消" class="btn" id="btnClear">
        </div>

    </article>
</body>

</html>